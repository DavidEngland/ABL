# Homework Exercise: Geometric Mean Height and Richardson Number Bias via Jensen's Inequality

**Course:** Boundary Layer Meteorology / Advanced Atmospheric Physics  
**Topic:** Grid Sensitivity in Stable Boundary Layer Parameterizations  
**Difficulty:** Graduate Level  
**Estimated Time:** 2–3 hours

---

## Problem Statement

Atmospheric models discretize the vertical using finite layers. In the stable boundary layer (SBL), the **bulk Richardson number** $Ri_b$ computed across a layer systematically differs from the **gradient Richardson number** $Ri_g$ evaluated at a representative height. Your task is to prove that when $Ri_g(z)$ is concave-down (typical in SBL), the layer-averaged $Ri_b$ underestimates the point value at the geometric mean height $z_g = \sqrt{z_0 z_1}$.

**Key Result to Prove:**
$$
Ri_b = \frac{1}{\Delta z}\int_{z_0}^{z_1} Ri_g(z)\,dz < Ri_g(z_g)
$$
where $\Delta z = z_1 - z_0$ and $z_g = \sqrt{z_0 z_1}$.

---

## Part A: Jensen's Inequality (Warm-Up)

**Hint:** Jensen's inequality states that for a **concave** function $f$,
$$
f\!\left(\frac{1}{b-a}\int_a^b x\,dx\right) \geq \frac{1}{b-a}\int_a^b f(x)\,dx.
$$

**A1.** State Jensen's inequality for a concave function. What conditions must $f$ satisfy? What does "concave" mean in terms of the second derivative?

**A2.** The natural logarithm $\ln(z)$ is concave. Prove this by computing $d^2(\ln z)/dz^2$ and showing it is negative for $z > 0$.

---

## Part B: Why Geometric Mean Height?

**B1.** The **logarithmic mean** of $z_0$ and $z_1$ is defined as
$$
\bar{z}_{\ln} = \frac{z_1 - z_0}{\ln(z_1) - \ln(z_0)} = \frac{\Delta z}{\ln(z_1/z_0)}.
$$
Show that for a log-linear wind profile $U(z) = (u_*/\kappa) \ln(z/z_0) + C$, evaluating the gradient $\partial U/\partial z$ at $\bar{z}_{\ln}$ gives the **exact** layer-averaged gradient:
$$
\frac{\Delta U}{\Delta z} = \left.\frac{\partial U}{\partial z}\right|_{z=\bar{z}_{\ln}}.
$$

**B2.** The **geometric mean** height is
$$
z_g = \sqrt{z_0 z_1}.
$$
Show that $z_g$ is the midpoint in **logarithmic coordinates**:
$$
\ln z_g = \frac{\ln z_0 + \ln z_1}{2}.
$$

**B3.** For thin layers ($z_1/z_0 \to 1$), prove that $\bar{z}_{\ln} \approx z_g$ to second order in $\ln(z_1/z_0)$ by Taylor expanding:
$$
\frac{\Delta z}{\ln(z_1/z_0)} \approx z_g \left[1 + O\big((\ln(z_1/z_0))^2\big)\right].
$$

**Hint:** Use $\ln(z_1/z_0) = \ln(1 + (z_1-z_0)/z_0) \approx (z_1-z_0)/z_0 - \ldots$

---

## Part C: Concave-Down $Ri_g$ and Bias

Assume $Ri_g(z)$ is **concave-down** (i.e., $d^2 Ri_g/dz^2 < 0$) over the interval $[z_0, z_1]$.

**C1.** Apply Jensen's inequality to $Ri_g(z)$ treated as a concave function. Specifically, show that
$$
\frac{1}{\Delta z}\int_{z_0}^{z_1} Ri_g(z)\,dz < Ri_g\!\left(\frac{1}{\Delta z}\int_{z_0}^{z_1} z\,dz\right).
$$

What is the arithmetic mean height $\bar{z}_a = (z_0 + z_1)/2$ in this context?

**C2.** We want to compare $Ri_b$ to $Ri_g$ at the **geometric** mean $z_g$, not the arithmetic mean. Use the fact that $\ln(z)$ is concave to show:
$$
\ln(z_g) = \frac{\ln z_0 + \ln z_1}{2} > \ln\!\left(\frac{z_0 + z_1}{2}\right) = \ln(\bar{z}_a).
$$

Thus $z_g < \bar{z}_a$ for $z_0 < z_1$.

**C3.** For a power-law or logarithmic profile structure, $Ri_g(z)$ is better approximated as concave in $\ln z$ rather than $z$. Change variables $s = \ln z$, so $z \in [z_0, z_1]$ maps to $s \in [\ln z_0, \ln z_1]$. Define
$$
\tilde{Ri}(s) = Ri_g(e^s).
$$

If $\tilde{Ri}(s)$ is concave in $s$, apply Jensen to show:
$$
\frac{1}{\ln(z_1/z_0)}\int_{\ln z_0}^{\ln z_1} \tilde{Ri}(s)\,ds < \tilde{Ri}\!\left(\frac{\ln z_0 + \ln z_1}{2}\right) = Ri_g(z_g).
$$

**C4.** Convert the integral back to $z$ coordinates using $dz = e^s ds = z\,ds$:
$$
\int_{\ln z_0}^{\ln z_1} \tilde{Ri}(s)\,ds = \int_{z_0}^{z_1} Ri_g(z)\,\frac{dz}{z}.
$$

This is the **logarithmically weighted average**. For a thin layer or when $Ri_g$ varies slowly, approximate
$$
\frac{1}{\ln(z_1/z_0)}\int_{z_0}^{z_1} Ri_g(z)\,\frac{dz}{z} \approx \frac{1}{\Delta z}\int_{z_0}^{z_1} Ri_g(z)\,dz = Ri_b.
$$

Conclude:
$$
Ri_b \lesssim Ri_g(z_g)
$$
when $Ri_g$ is concave-down in $\ln z$.

---

## Part D: Numerical Verification

**D1.** Assume a quadratic near-neutral form:
$$
Ri_g(z) = c_1 z + c_2 z^2,
$$
with $c_1 > 0$, $c_2 < 0$ (concave-down).

Choose $z_0 = 10$ m, $z_1 = 100$ m, $c_1 = 0.01$, $c_2 = -0.0001$.

Compute:

- $z_g = \sqrt{z_0 z_1}$
- $Ri_g(z_g)$
- $Ri_b = \frac{1}{\Delta z}\int_{z_0}^{z_1} Ri_g(z)\,dz$ (evaluate the integral analytically)
- Bias ratio $B = Ri_g(z_g) / Ri_b$

**D2.** Repeat for a logarithmic structure:
$$
Ri_g(z) = A \ln(z/z_{\text{ref}}) + C,
$$
with $A > 0$, $C > 0$, $z_{\text{ref}} = 1$ m. Note that $d^2/dz^2[\ln(z)] = -1/z^2 < 0$ (concave).

Compute $B$ again. Is $B > 1$?

---

## Part E: Physical Interpretation

**E1.** In your own words, explain why $Ri_b < Ri_g(z_g)$ leads to **overmixing** in a numerical model. Specifically, how does underestimating stability affect the computed eddy diffusivities $K_m$ and $K_h$?

**E2.** If a model uses the **arithmetic mean** height $\bar{z}_a = (z_0 + z_1)/2$ instead of $z_g$, does the bias worsen or improve? Justify using Part C.

**E3.** Suggest one practical correction strategy to mitigate this bias without changing the vertical grid resolution. (Hint: Think about modifying $K_{m,h}$ or using a representative height correction.)

---

## Submission Guidelines

- **Format:** Typed solutions (LaTeX preferred; Markdown with math acceptable).
- **Code:** Include Python/Julia/MATLAB scripts for Part D with plots of $Ri_g(z)$, $z_g$, and bias ratio.
- **Figures:** Plot $Ri_g(z)$ vs $z$ with horizontal line at $Ri_g(z_g)$ and shaded region showing layer $[z_0, z_1]$.
- **Length:** ~5–8 pages including derivations and figures.

---

## Additional Challenge (Optional, +10%)

Derive an **exact correction factor** $G(\Delta z, \Delta)$ such that
$$
Ri_b^{\text{corrected}} = Ri_b \times G \approx Ri_g(z_g),
$$
where $\Delta = d^2 Ri_g/dz^2$ is the local curvature. Express $G$ in terms of $z_0$, $z_1$, and $\Delta$ to leading order in $\Delta z$.

**Hint:** Use Taylor expansion of $Ri_g$ around $z_g$.

---

## Learning Objectives

By completing this exercise, you will:

1. Understand Jensen's inequality and its application to atmospheric profiles.
2. Justify the use of geometric mean height in log-structured boundary layers.
3. Quantify systematic bias in bulk Richardson number due to curvature.
4. Develop intuition for grid-sensitivity issues in stable layer parameterizations.

---

**Instructor Notes:**  
This problem bridges mathematical analysis (Jensen, concavity) with physical intuition (mixing, stability) and numerical verification. It prepares students for advanced topics in turbulence closures and grid-aware parameterization design. Solution key available upon request.
